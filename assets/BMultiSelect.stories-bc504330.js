import{j as ne,b as m,k as g,C as E,E as de,g as ue,o as u,d as r,m as o,l as N,n as i,u as C,F,G as O,q as j,s as z,t as y,B as oe,w as re,x as ie,H as S,J as ce}from"./vue.esm-bundler-0b71992c.js";import{u as fe}from"./Validation-bd4eb4eb.js";import{u as T,l as ve,e as pe,r as me}from"./ComponentHelper-d29c08d8.js";import{u as ge}from"./vue-i18n.esm-bundler-ed524c22.js";import{B as xe}from"./BCheckbox-1e5ef4d5.js";import{_ as be}from"./BErrorMessage-f720f12c.js";import{_ as he}from"./BLabel-eed86ef0.js";import{_ as ke}from"./BTextField-330fcc50.js";import{v as Ce}from"./v4-a960c1f4.js";import"./Enums-9e395f7e.js";import"./_plugin-vue_export-helper-c27b6911.js";const ye={class:"ds-absolute ds-right-3 ds-z-[1]"},we=["onClick"],Ve=["id","disabled"],Me=["id","data-cy","data-ut"],$e={class:"ds-max-h-72 ds-overflow-y-auto ds-rounded-lg ds-bg-white ds-shadow"},Be={class:"ds-py-1 ds-text-sm ds-text-black/[0.85]"},Ie=["onClick"],_=ne({__name:"BMultiSelect",props:{inputId:{default:""},modelValue:{},label:{default:""},items:{},disabled:{type:Boolean,default:!1},placeholder:{default:""},valueCssClass:{default:""},menuCssClass:{default:""},validationRules:{default:void 0},required:{type:Boolean,default:!1},requiredErrorMessage:{default:""},hideDetails:{type:Boolean,default:!1},showSelectedItemCount:{type:Boolean,default:!1},allowInput:{type:Boolean,default:!1}},emits:["update:modelValue","change","open","close","change:input"],setup(V,{expose:H,emit:f}){const a=V,x=m(null),M=m(null),b=m(null),n=m(!1),{t:q}=ge(),J={validateRule:e=>!!e&&e.length>0,errorMessage:()=>a.requiredErrorMessage||q("ds.global.field_required")},$=m(""),c=m([]),h=g(()=>a.inputId||`id-${Ce()}`),t=g({get(){return a.modelValue},set(e){f("update:modelValue",e)}}),A=g(()=>{let e="ds-border ds-drop-shadow-light ds-text-sm ds-h-[40px] ds-px-3 ds-rounded-lg ds-block ds-w-full ds-inline-flex ds-items-center ds-justify-between ";return e+=a.disabled?"ds-cursor-not-allowed ds-bg-[#f2f2f2] ds-text-black/[0.4] ":"ds-bg-white ds-text-black/[0.85] ",e+=v.value.valid?"ds-border-black/10 focus:ds-border-focus focus:ds-ring-1 focus:ds-ring-focus ":"ds-border-error focus:ds-ring-1 focus:ds-ring-error ",e}),K=g(()=>{let e=[];return a.required&&e.push(J),a.validationRules&&(e=e.concat(a.validationRules)),e.length?e:void 0}),Q=g(()=>{var e,s;return((e=t.value)==null?void 0:e.length)>1?` (${q("ds.components.base.multi_select.selected_item_count",{count:(s=t.value)==null?void 0:s.length})})`:""}),X=g(()=>a.showSelectedItemCount?`${a.label}${Q.value}`:a.label),{validate:B,validationResult:v}=fe(h.value,t,K.value);E(n,e=>{e?(ve(),le(),f("open")):(T(),P(),f("close"))}),E(t,()=>{I()},{deep:!0}),E(()=>a.items,()=>{t.value.length!==0&&c.value.length===0&&I()},{deep:!0});const I=()=>{c.value=t.value.map(e=>{let s=c.value.find(d=>d.value===e);return s||(s=a.items.find(d=>d.value===e)),{text:s==null?void 0:s.text,value:e,cssClass:s==null?void 0:s.cssClass}})},Y=()=>{document.addEventListener("keydown",R)},R=e=>{e.key==="Escape"&&L()},Z=()=>{document.addEventListener("click",D)},D=e=>{[x.value,b.value].some(l=>e.composedPath().includes(l))||L()},ee=e=>{const s=t.value.findIndex(d=>d===e.value);s!==-1?t.value.splice(s,1):t.value.push(e.value),f("change",e.value),S(()=>{B()})},se=(e,s)=>{s.style.width=`${e.offsetWidth}px`},le=()=>{S(()=>{pe(x.value,b.value),se(x.value,b.value)})},P=()=>{me(x.value,b.value)},ae=e=>{f("change:input",e)},L=()=>{var e;n.value=!1,(e=M.value)==null||e.blur(),$.value=""},te=e=>{const s=t.value.findIndex(d=>d===e.value);s!==-1&&(t.value.splice(s,1),f("change",e.value),S(()=>{B()}))};return(()=>{a.items.length>0&&I()})(),de(()=>{Y(),Z()}),ue(()=>{document.removeEventListener("keydown",R),document.removeEventListener("click",D),T(),P()}),H({validate:B,selectMenu:n}),(e,s)=>{var d;return u(),r("div",null,[o("div",{ref_key:"selectEl",ref:x},[N(he,{id:h.value,label:X.value,required:e.required},null,8,["id","label","required"]),a.allowInput?(u(),r("div",{key:0,class:i([{"ds-border-focus ds-ring-1 ds-ring-focus":n.value&&C(v).valid,"ds-ring-1 ds-ring-error":n.value&&!C(v).valid,"ds-border-black/10":C(v).valid,"ds-border-error":!C(v).valid},"ds-relative ds-flex ds-flex-wrap ds-items-center ds-gap-x-1 ds-rounded-lg ds-border ds-bg-white ds-px-3 ds-py-1 ds-drop-shadow-light"])},[o("div",ye,[o("i",{class:i(`fa-solid fa-caret-down ds-transition-transform ${n.value?"ds-rotate-180":""}`),onClick:s[0]||(s[0]=l=>{var p;return(p=M.value)==null?void 0:p.focus()})},null,2)]),(u(!0),r(F,null,O(c.value,(l,p)=>(u(),r("div",{key:`item${p}`,class:"ds-my-0.5 ds-flex-initial ds-space-x-1 ds-rounded-lg ds-bg-black/10 ds-px-2"},[o("span",null,y(l.text),1),o("i",{class:"fa-solid fa-circle-xmark ds-cursor-pointer ds-text-black/60 hover:ds-text-black/40",onClick:k=>te(l)},null,8,we)]))),128)),a.allowInput?(u(),j(ke,{key:0,id:h.value,ref_key:"inputRef",ref:M,modelValue:$.value,"onUpdate:modelValue":[s[1]||(s[1]=l=>$.value=l),ae],disabled:a.disabled,class:"ds-flex-auto","hide-details":"","input-css-class":"ds-drop-shadow-none ds-border-none !ds-ring-0 ds-px-0 !ds-h-[30px] ds-pl-0",onFocus:s[2]||(s[2]=l=>n.value=!0)},null,8,["id","modelValue","disabled"])):z("",!0)],2)):(u(),r("button",{key:1,id:h.value,class:i(A.value),disabled:e.disabled,type:"button",onClick:s[3]||(s[3]=l=>n.value=!n.value)},[c.value.length>0?(u(),r("span",{key:0,class:i([e.valueCssClass,"ds-truncate ds-text-sm"])},y((d=c.value)==null?void 0:d.map(l=>l.text).join(", ")),3)):(u(),r("span",{key:1,class:i([e.valueCssClass,"ds-truncate ds-text-sm ds-text-black/[0.4]"])},y(a.placeholder),3)),oe(" Â  "),o("span",{class:i([`${n.value?"ds-rotate-180":""}`,"fa-solid fa-caret-down ds-text-base ds-transition-transform"])},null,2)],10,Ve)),re(o("div",{id:`${h.value}Menu`,ref_key:"selectMenuEl",ref:b,class:i([e.menuCssClass,"ds-absolute ds-z-50 ds-min-w-[8rem] ds-py-1"]),"data-cy":e.$attrs["data-cy"]?`${e.$attrs["data-cy"]}Menu`:void 0,"data-ut":e.$attrs["data-ut"]?`${e.$attrs["data-ut"]}Menu`:void 0},[o("div",$e,[o("ul",Be,[(u(!0),r(F,null,O(e.items,(l,p)=>(u(),r("li",{key:`item${p}`,class:"ds-cursor-pointer",onClick:ce(k=>ee(l),["prevent"])},[o("a",{class:i([l.cssClass+`${c.value.some(k=>k.value===l.value)?" ds-bg-slate-100":""}`,"ds-flex ds-items-center ds-space-x-2 ds-px-4 ds-py-2 hover:ds-bg-slate-100"])},[N(xe,{modelValue:t.value,"onUpdate:modelValue":s[4]||(s[4]=k=>t.value=k),value:l.value,size:"sm"},null,8,["modelValue","value"]),o("span",null,y(l==null?void 0:l.text),1)],2)],8,Ie))),128))])])],10,Me),[[ie,n.value]])],512),e.hideDetails?z("",!0):(u(),j(be,{key:0,"error-message":C(v).errorMessage(),class:"ds-mt-1","prepend-icon":"fa-solid fa-circle-exclamation"},null,8,["error-message"]))])}}});_.__docgenInfo={exportName:"default",displayName:"BMultiSelect",description:"",tags:{},expose:[{name:"validate"},{name:"selectMenu"}],props:[{name:"inputId",defaultValue:{func:!1,value:"''"}},{name:"label",defaultValue:{func:!1,value:"''"}},{name:"disabled",defaultValue:{func:!1,value:"false"}},{name:"placeholder",defaultValue:{func:!1,value:"''"}},{name:"valueCssClass",defaultValue:{func:!1,value:"''"}},{name:"menuCssClass",defaultValue:{func:!1,value:"''"}},{name:"validationRules",defaultValue:{func:!1,value:"undefined"}},{name:"required",defaultValue:{func:!1,value:"false"}},{name:"requiredErrorMessage",defaultValue:{func:!1,value:"''"}},{name:"hideDetails",defaultValue:{func:!1,value:"false"}},{name:"showSelectedItemCount",defaultValue:{func:!1,value:"false"}},{name:"allowInput",defaultValue:{func:!1,value:"false"}}],events:[{name:"update:modelValue"},{name:"change"},{name:"open"},{name:"close"},{name:"change:input"}],sourceFiles:["/Users/thinhnguyen/Downloads/Projects/7PMLabs/7pmlabs-design-system/src/components/BMultiSelect.vue"]};const ze={title:"Components/MultiSelect",component:_,tags:["autodocs"],args:{inputId:"",label:"",disabled:!1,placeholder:"",valueCssClass:"",menuCssClass:"",validationRules:void 0,required:!1,requiredErrorMessage:"",hideDetails:!1,showSelectedItemCount:!1,allowInput:!1}},w={render:V=>({components:{BMultiSelect:_},setup(){return{args:V}},template:`
      <BMultiSelect
        v-bind="args"
      />
    `}),args:{modelValue:[2,5],items:[{text:"text 01",value:1},{text:"text 02",value:2},{text:"text 03",value:3},{text:"text 04",value:4},{text:"text 05",value:5},{text:"text 06",value:6}]}};var U,W,G;w.parameters={...w.parameters,docs:{...(U=w.parameters)==null?void 0:U.docs,source:{originalSource:`{
  render: (args: any) => ({
    components: {
      BMultiSelect
    },
    setup() {
      return {
        args
      };
    },
    template: \`
      <BMultiSelect
        v-bind="args"
      />
    \`
  }),
  args: {
    modelValue: [2, 5],
    items: [{
      text: 'text 01',
      value: 1
    }, {
      text: 'text 02',
      value: 2
    }, {
      text: 'text 03',
      value: 3
    }, {
      text: 'text 04',
      value: 4
    }, {
      text: 'text 05',
      value: 5
    }, {
      text: 'text 06',
      value: 6
    }]
  }
}`,...(G=(W=w.parameters)==null?void 0:W.docs)==null?void 0:G.source}}};const Te=["Default"];export{w as Default,Te as __namedExportsOrder,ze as default};
//# sourceMappingURL=BMultiSelect.stories-bc504330.js.map

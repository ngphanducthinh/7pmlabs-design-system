{"version":3,"file":"BDropdown.stories-7217765a.js","sources":["../../src/components/BDropdown/BDropdown.vue","../../src/components/BDropdown/BDropdownContent.vue","../../src/components/BDropdown/BDropdownItem.vue"],"sourcesContent":["<script lang=\"ts\" setup>\nimport {\n  ensureVisiblePosition,\n  resetPosition,\n} from '@/helpers/ComponentHelper';\nimport { v4 as uuid } from 'uuid';\nimport {\n  computed,\n  nextTick,\n  onBeforeUnmount,\n  onMounted,\n  provide,\n  ref,\n  watch,\n} from 'vue';\nimport { PIKey } from '@/constants/Common';\n\n/**\n * Props\n */\nexport interface BDropdownProps {\n  inputId?: string;\n  modelValue?: boolean;\n  label?: string;\n  /**\n   * Toggle's content text\n   */\n  text?: string;\n  /**\n   * CSS of toggle\n   */\n  toggleCssClass?: string;\n  /**\n   * CSS of menu\n   */\n  menuCssClass?: string;\n  /**\n   * Prevent menu from closing when clicking outside\n   */\n  noCloseOnClickOutside?: boolean;\n  /**\n   * Prevent menu from closing when \"Esc\" pressed\n   */\n  noCloseOnEsc?: boolean;\n  menuFixed?: boolean; // menu position should be fixed when toggle position is fixed\n}\nconst props = withDefaults(defineProps<BDropdownProps>(), {\n  inputId: '',\n  modelValue: undefined,\n  label: '',\n  text: '',\n  toggleCssClass: '',\n  menuCssClass: '',\n  noCloseOnClickOutside: false,\n  noCloseOnEsc: false,\n  menuFixed: false,\n});\n\n/**\n * Events\n */\nconst emit = defineEmits<{\n  'update:modelValue': [value: boolean];\n  hidden: [];\n  shown: [];\n}>();\n\n/**\n * Data\n */\nconst toggle = ref<HTMLElement | null>(null);\nconst dropdown = ref<HTMLElement | null>(null);\nconst dropdownMenu = ref<HTMLElement | null>(null);\nconst mValue = ref(false);\nconst id = computed(() => props.inputId || `id-${uuid()}`);\nconst value = computed({\n  get() {\n    return props.modelValue !== undefined ? props.modelValue : mValue.value;\n  },\n  set(val: boolean) {\n    if (props.modelValue !== undefined) {\n      emit('update:modelValue', val);\n    } else {\n      mValue.value = val;\n    }\n  },\n});\n\n/**\n * Watch\n */\nwatch(value, (val) => {\n  if (val) {\n    ensureMenuPosition();\n  } else {\n    resetMenuPosition();\n    toggle.value?.blur();\n  }\n});\n\n/**\n * Watch\n */\nwatch(\n  () => props.noCloseOnClickOutside,\n  (val) => {\n    if (val) {\n      removeClickOutsideEventListener();\n    } else {\n      initClickOutsideEventListener();\n    }\n  },\n);\n\nwatch(\n  () => props.noCloseOnEsc,\n  (val) => {\n    if (val) {\n      removePressEscapeEventListener();\n    } else {\n      initPressEscapeEventListener();\n    }\n  },\n);\n\n/**\n * Methods\n */\nconst initPressEscapeEventListener = () => {\n  document.addEventListener('keydown', closeOnEscapePressed);\n};\nconst closeOnEscapePressed = (event: any) => {\n  if (event.key === 'Escape') {\n    close();\n  }\n};\nconst initClickOutsideEventListener = () => {\n  document.addEventListener('click', closeOnClickOutside);\n};\nconst closeOnClickOutside = (event: any) => {\n  const refs = [dropdown.value, dropdownMenu.value];\n  const withinBoundaries = refs.some((r) => event.composedPath().includes(r));\n  if (!withinBoundaries) {\n    close();\n  }\n};\nconst onClickToggle = () => {\n  value.value = !value.value;\n};\nconst ensureMenuPosition = () => {\n  nextTick(() => {\n    ensureVisiblePosition(\n      dropdown.value!,\n      dropdownMenu.value!,\n      props.menuFixed,\n    );\n    emit('shown');\n  });\n};\nconst resetMenuPosition = () => {\n  resetPosition(dropdown.value!, dropdownMenu.value!);\n  emit('hidden');\n};\nconst close = () => {\n  value.value = false;\n};\nconst removePressEscapeEventListener = () => {\n  document.removeEventListener('keydown', closeOnEscapePressed);\n};\nconst removeClickOutsideEventListener = () => {\n  document.removeEventListener('click', closeOnClickOutside);\n};\n\n/**\n * Lifecycle Hooks\n */\nonMounted(() => {\n  if (!props.noCloseOnEsc) {\n    initPressEscapeEventListener();\n  }\n  if (!props.noCloseOnClickOutside) {\n    initClickOutsideEventListener();\n  }\n});\nonBeforeUnmount(() => {\n  removePressEscapeEventListener();\n  removeClickOutsideEventListener();\n  // Make sure dropdown menu unmounted with itself\n  resetMenuPosition();\n});\n\n/**\n * Provide\n */\nprovide(PIKey.CloseDropdown, close);\n</script>\n\n<template>\n  <div ref=\"dropdown\">\n    <label\n      v-if=\"props.label\"\n      :for=\"id\"\n      class=\"ds-mb-2 ds-block ds-text-xs ds-font-bold ds-capitalize ds-text-gray-500\"\n    >\n      {{ props.label }}\n    </label>\n    <button\n      :id=\"id\"\n      ref=\"toggle\"\n      :class=\"toggleCssClass\"\n      class=\"ds-inline-flex ds-w-full ds-items-center ds-justify-between ds-rounded-lg ds-bg-gray-200 ds-px-3 ds-py-2 ds-text-gray-700 focus:ds-ring-1 focus:ds-ring-primary-t\"\n      type=\"button\"\n      @click=\"onClickToggle\"\n    >\n      <slot name=\"toggle\">\n        <span class=\"ds-truncate\">{{ props.text }}</span>\n        &nbsp;\n        <svg\n          :class=\"`${value ? 'ds-rotate-180' : ''}`\"\n          class=\"ds-h-4 ds-w-4 ds-transition-transform\"\n          viewBox=\"0 0 320 512\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path\n            d=\"M137.4 374.6c12.5 12.5 32.8 12.5 45.3 0l128-128c9.2-9.2 11.9-22.9 6.9-34.9s-16.6-19.8-29.6-19.8L32 192c-12.9 0-24.6 7.8-29.6 19.8s-2.2 25.7 6.9 34.9l128 128z\"\n          />\n        </svg>\n      </slot>\n    </button>\n    <div\n      v-show=\"value\"\n      :id=\"`${id}Menu`\"\n      ref=\"dropdownMenu\"\n      :class=\"`${menuCssClass} ${props.menuFixed ? 'ds-fixed' : 'ds-absolute'}`\"\n      :data-cy=\"$attrs['data-cy'] ? `${$attrs['data-cy']}Menu` : undefined\"\n      :data-ut=\"$attrs['data-ut'] ? `${$attrs['data-ut']}Menu` : undefined\"\n      class=\"ds-z-50 ds-py-1\"\n    >\n      <slot></slot>\n    </div>\n  </div>\n</template>\n","<script setup lang=\"ts\"></script>\n\n<template>\n  <ul class=\"ds-rounded-lg ds-bg-white ds-p-2 ds-shadow\">\n    <slot></slot>\n  </ul>\n</template>\n","<script lang=\"ts\" setup>\nimport { inject } from 'vue';\nimport { PIKey } from '@/constants/Common';\n\n/**\n * Props\n */\nexport interface Props {\n  closeOnClick?: boolean;\n}\nconst props = withDefaults(defineProps<Props>(), {\n  closeOnClick: false,\n});\nconst closeDropdown = inject(PIKey.CloseDropdown);\n\nconst onClick = () => {\n  if (props.closeOnClick && closeDropdown) {\n    closeDropdown();\n  }\n};\n</script>\n\n<template>\n  <li\n    class=\"ds-cursor-pointer ds-px-3 ds-py-2 ds-text-sm ds-text-gray-700 hover:ds-bg-slate-100\"\n    @click=\"onClick\"\n  >\n    <slot></slot>\n  </li>\n</template>\n"],"names":["toggle","ref","dropdown","dropdownMenu","mValue","id","computed","props","uuid","value","val","emit","watch","ensureMenuPosition","resetMenuPosition","_a","removeClickOutsideEventListener","initClickOutsideEventListener","removePressEscapeEventListener","initPressEscapeEventListener","closeOnEscapePressed","event","close","closeOnClickOutside","r","onClickToggle","nextTick","ensureVisiblePosition","resetPosition","onMounted","onBeforeUnmount","provide","PIKey","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_hoisted_1","closeDropdown","inject","onClick"],"mappings":"kgCAsEMA,EAASC,EAAwB,IAAI,EACrCC,EAAWD,EAAwB,IAAI,EACvCE,EAAeF,EAAwB,IAAI,EAC3CG,EAASH,EAAI,EAAK,EAClBI,EAAKC,EAAS,IAAMC,EAAM,SAAW,MAAMC,GAAM,EAAE,EACnDC,EAAQH,EAAS,CACrB,KAAM,CACJ,OAAOC,EAAM,aAAe,OAAYA,EAAM,WAAaH,EAAO,KACpE,EACA,IAAIM,EAAc,CACZH,EAAM,aAAe,OACvBI,EAAK,oBAAqBD,CAAG,EAE7BN,EAAO,MAAQM,CAEnB,CAAA,CACD,EAKKE,EAAAH,EAAQC,GAAQ,OAChBA,EACiBG,KAEDC,KAClBC,EAAAf,EAAO,QAAP,MAAAe,EAAc,OAChB,CACD,EAKDH,EACE,IAAML,EAAM,sBACXG,GAAQ,CACHA,EAC8BM,IAEFC,GAElC,CAAA,EAGFL,EACE,IAAML,EAAM,aACXG,GAAQ,CACHA,EAC6BQ,IAEFC,GAEjC,CAAA,EAMF,MAAMA,EAA+B,IAAM,CAChC,SAAA,iBAAiB,UAAWC,CAAoB,CAAA,EAErDA,EAAwBC,GAAe,CACvCA,EAAM,MAAQ,UACVC,GACR,EAEIL,EAAgC,IAAM,CACjC,SAAA,iBAAiB,QAASM,CAAmB,CAAA,EAElDA,EAAuBF,GAAe,CAC7B,CAACnB,EAAS,MAAOC,EAAa,KAAK,EAClB,KAAMqB,GAAMH,EAAM,eAAe,SAASG,CAAC,CAAC,GAElEF,GACR,EAEIG,EAAgB,IAAM,CACpBhB,EAAA,MAAQ,CAACA,EAAM,KAAA,EAEjBI,EAAqB,IAAM,CAC/Ba,EAAS,IAAM,CACbC,EACEzB,EAAS,MACTC,EAAa,MACbI,EAAM,SAAA,EAERI,EAAK,OAAO,CAAA,CACb,CAAA,EAEGG,EAAoB,IAAM,CAChBc,EAAA1B,EAAS,MAAQC,EAAa,KAAM,EAClDQ,EAAK,QAAQ,CAAA,EAETW,EAAQ,IAAM,CAClBb,EAAM,MAAQ,EAAA,EAEVS,EAAiC,IAAM,CAClC,SAAA,oBAAoB,UAAWE,CAAoB,CAAA,EAExDJ,EAAkC,IAAM,CACnC,SAAA,oBAAoB,QAASO,CAAmB,CAAA,EAM3D,OAAAM,EAAU,IAAM,CACTtB,EAAM,cACoBY,IAE1BZ,EAAM,uBACqBU,GAChC,CACD,EACDa,EAAgB,IAAM,CACWZ,IACCF,IAEdF,GAAA,CACnB,EAKOiB,EAAAC,EAAM,cAAeV,CAAK,mzEC/LhC,SAAAW,GAAAC,EAAAC,EAAA,QACeC,EAAA,EAAAC,EAAA,KAAAC,GAAA,uWCSXC,EAAgBC,EAAOR,EAAM,aAAa,EAE1CS,EAAU,IAAM,CAChBlC,EAAM,cAAgBgC,GACVA,GAChB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}